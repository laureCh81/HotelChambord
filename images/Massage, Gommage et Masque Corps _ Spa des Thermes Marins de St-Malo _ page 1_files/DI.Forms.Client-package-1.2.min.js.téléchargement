null==window.ofsysGenericClientForm&&(window.ofsysGenericClientForm={});null==window.ofsysGenericClientForm.util&&(window.ofsysGenericClientForm.util={});
(function(d){function m(a,f){var c=Object.prototype.toString.call(f).slice(8,-1);return void 0!==f&&null!==f&&c===a}function h(a){return isFinite(a)&&0===a%1}function l(a){return JSON.parse(JSON.stringify(a))}function e(a,f){if(f.bind)return f.bind(a);var c=[],b=function(){},k=function(){return f.apply(a,c.concat(Array.prototype.slice.call(arguments)))};b.prototype=f.prototype;k.prototype=new b;return k}d.getObjType=function(a){return Object.prototype.toString.call(a).slice(8,-1)};d.is=m;d.isNumber=
function(a){return!isNaN(parseFloat(a))&&isFinite(a)};d.isInt=h;d.convertToArray=function(a){for(var c=[],b=0;b<a.length;b++)c.push(a[b]);return c};d.clone=l;d.methodRef=e;d.isIE8OrOlder=function(){return null!=window.attachEvent&&null==window.addEventListener};d.isIE9OrOlder=function(){return d.isIE8OrOlder()||null!=document.documentMode&&(null==window.performance||10>document.documentMode)};d.parseInt=function(a){if(null==a||""===a||!isFinite(a)||0!==a%1)throw Error("Not an int : '"+a+"'");return parseInt(a,
"10")};d.getURLParameters=function(){var a=window.location.search.slice(1),f={};if(null==a||""==a)return f;for(var a=decodeURIComponent(a).split("&"),b=0;b<a.length;b++){var d=a[b].split("=");f[d[0]]=d[1]}return f};d.coalesce=function(){for(var a=0;a<arguments.length;a++)if(null!=arguments[a])return arguments[a];return null};d.prefixZeros=function(a,b){var c=b-a.toString().length;return 0>=c?a:Array(c+1).join("0")+a.toString()};d.formatNumber=function(a,b,d){if(!h(a)){var c;c=null!=b?Math.pow(10,
b):100;a=Math.round(a*c)/c}c=/^(-?[0-9]+)([0-9]{3})/;for(a+="";c.test(a);)a=a.replace(c,"$1 $2");if(d)for(-1==a.indexOf(".")&&(a+="."),d=a.afterLast(".").length;d<b;d++)a+="0";return a};d.formatFloatNumber=function(a,b){null==b&&(b=2);var c;c=null!=b?Math.pow(10,b):100;a=Math.round(a*c)/c;var f=/(-?[0-9]+)([0-9]{3})/;for(c=a+"";f.test(c);)c=c.replace(f,"$1 $2");-1==c.indexOf(".")&&(c+=".0");f=c.afterLast(".");if(f.length<b)for(var k=0;k<b-f.length;k++)c+="0";return c};d.assert=function(a,b){if(!a){if(null==
b)throw Error("assertion failure");throw Error(b);}};d.net={};d.net.ajax=function(a){var b=new XMLHttpRequest;b.onreadystatechange=function(){4==b.readyState&&(200==b.status?a.success&&a.success(b.responseText,b):a.error&&a.error(b.status,b.responseText,b))};var c=a.method||"POST";b.open(c,a.url,!0);null!=a.timeout&&(b.timeout=a.timeout);var d=null;if(null!=a.data)if(d="",m("String",a.data))b.setRequestHeader("Content-type","text/plain"),d=a.data;else if(m("Object",a.data)){"POST"==c&&b.setRequestHeader("Content-type",
"application/x-www-form-urlencoded");for(var k in a.data)0<d.length&&(d+="&"),d+=encodeURIComponent(k)+"="+encodeURIComponent(a.data[k])}else throw Error("data type");b.send(d)};d.net.corsAjax=function(a){try{var b=new XMLHttpRequest;if(null==window.XDomainRequest||"withCredentials"in b)b.open("POST",a.url,!0),b.setRequestHeader("Content-type","text/plain"),b.onreadystatechange=function(){4==b.readyState&&(200==b.status?a.success(b.responseText):a.error(b.status,b.responseText))},b.send(a.data);else{var c=
new XDomainRequest;c.open("POST",a.url);c.ontimeout=function(){a.error(408,"timeout")};c.onerror=function(){a.error(500,"error")};c.onload=function(){a.success(c.responseText)};setTimeout(function(){c.send(a.data)},0)}}catch(q){a.error(500,"exception "+q),window.console&&console.error(q)}};var a=d.string={};a.trim=function(a){return a.replace(/^\s+|\s+$/g,"")};a.formatTemplate=function(a,b){return a.replace(/([{]\w+[}])/g,function(a,c,f,d){return null!=b[a]?b[a]:a})};a=d.datetime={};a.buildDateWithStrictValidation=
function(a,b,d,e,k,p){var c=new Date(a,b,d,e,k,p,0);return c.getFullYear()!=a||c.getMonth()!=b||c.getDate()!=d||c.getHours()!=e||c.getMinutes()!=k||c.getSeconds()!=p?null:c};a.parseOFSYSDateTime=function(a){var b=/^(\d+)[.-](\d+)[.-](\d+) (\d+):(\d+):(\d+)$/gm.exec(a),c=null;if(null!=b&&7==b.length){a=d.parseInt(b[1]);var c=d.parseInt(b[2])-1,e=d.parseInt(b[3]),k=d.parseInt(b[4]),p=d.parseInt(b[5]),b=d.parseInt(b[6]),c=d.datetime.buildDateWithStrictValidation(a,c,e,k,p,b)}else b=/^(\d+)[.-](\d+)[.-](\d+) (\d+):(\d+)$/gm.exec(a),
null!=b&&6==b.length?(a=d.parseInt(b[1]),c=d.parseInt(b[2])-1,e=d.parseInt(b[3]),k=d.parseInt(b[4]),p=d.parseInt(b[5]),c=d.datetime.buildDateWithStrictValidation(a,c,e,k,p,0)):(b=/^(\d+)[.-](\d+)[.-](\d+)$/gm.exec(a),null!=b&&4==b.length&&(a=d.parseInt(b[1]),c=d.parseInt(b[2])-1,e=d.parseInt(b[3]),c=d.datetime.buildDateWithStrictValidation(a,c,e,0,0,0)));return c};a.parseOFSYSTime=function(a){var b=/^(\d+):(\d+):(\d+)$/gm.exec(a);if(null!=b&&4==b.length){a=d.parseInt(b[1]);var c=d.parseInt(b[2]),
b=d.parseInt(b[3]);if(null!=d.datetime.buildDateWithStrictValidation(2001,1,1,a,c,b))return{HH:a,mm:c,ss:b}}else if(b=/^(\d+):(\d+)$/gm.exec(a),null!=b&&3==b.length&&(a=d.parseInt(b[1]),c=d.parseInt(b[2]),null!=d.datetime.buildDateWithStrictValidation(2001,1,1,a,c,0)))return{HH:a,mm:c,ss:0};return null};var b={DeclareClassWithVariables:function(a){var c=b.DeclareClass(!0,a.methods,a.name,a.variables);if(null!=a["static"]){c.__STATIC__=a["static"];for(var d in a["static"])c[d]=a["static"][d]}return c},
DeclareClass:function(a,d,e,q){var c=function(){this.ClassName=e;if(null!=q){for(var b in q)this[b]=null!=q[b]&&(m("Object",q[b])||m("Array",q[b]))?l(q[b]):q[b];a&&null!=Object.seal&&Object.seal(this);null!=this.init&&this.init.apply(this,arguments)}};c.prototype=d;b.AddCommonClassMethods(c);c.Variables=q;c.ClassName=e;for(var p in d){var f=d[p];null!=f&&(c[p]=f)}return c},AddCommonClassMethods:function(a){a.prototype.CallMethod=function(a){return e(this,a)};a.Extend=function(c){var d=b.ExtendClass(!0,
this,c.methods,c.name,c.variables);if(null!=a.__STATIC__)for(var f in a.__STATIC__)d[f]=a.__STATIC__[f];if(null!=c["static"])for(f in c["static"])d[f]=c["static"][f];return d}},ExtendClass:function(a,d,e,q,k){var c;if(null!=Object.create){var f={},n;for(n in e){var r=e[n];null!=r?f[n]={value:e[n],enumerable:!0,configurable:!0,writable:!0}:(c=Object.getOwnPropertyDescriptor(e,n).get,r=Object.getOwnPropertyDescriptor(e,n).set,null!=c&&null!=r?f[n]={configurable:!1,get:c,set:r}:null!=c?f[n]={configurable:!1,
get:c}:null!=r&&(f[n]={configurable:!1,set:r}))}if(null!=d.Variables){e={};for(n in d.Variables)e[n]=d.Variables[n];if(null!=k)for(n in k)e[n]=k[n];k=e}c=function(){this.ClassName=q;if(null!=k){for(var b in k)this[b]=null!=k[b]&&(m("Object",k[b])||m("Array",k[b]))?l(k[b]):k[b];a&&null!=Object.seal&&Object.seal(this);null!=this.init&&this.init.apply(this,arguments)}};c.prototype=Object.create(d.prototype,f);c.BasePrototype=d.prototype;c.BaseClass=d;c.Variables=k}else{c=function(){this.ClassName=q;
if(null!=k){for(var b in k)this[b]=null!=k[b]&&(m("Object",k[b])||m("Array",k[b]))?l(k[b]):k[b];a&&null!=Object.seal&&Object.seal(this);null!=this.init&&this.init.apply(this,arguments)}};r={};for(n in d.prototype)r[n]=d.prototype[n];for(n in e)r[n]=e[n];c.prototype=r;c.BasePrototype=d.prototype;c.BaseClass=d}c.ClassName=q;b.AddCommonClassMethods(c);for(var g in f)r=f[g],null!=r.value&&(r=r.value),c[g]=r;return c}};d.classes=b})(window.ofsysGenericClientForm.util);
null==window.ofsysGenericClientForm&&(window.ofsysGenericClientForm={});null==window.ofsysGenericClientForm.dom&&(window.ofsysGenericClientForm.dom={});
(function(d){function m(a){this.elem=a}function h(a){this.elems=a}var l=window.ofsysGenericClientForm;d.Elem=m;m.prototype={findAll:function(a){return d._selectAll(a,this.elem)},find1:function(a){return d._select1(a,this.elem)},nextOrNull:function(){var a;if(this.elem.nextElementSibling)a=this.elem.nextElementSibling;else for(a=this.elem.nextSibling;null!=a&&1!==a.nodeType;)a=a.nextSibling;return null==a?null:new d.Elem(a)},next:function(){var a=this.nextOrNull();if(null==a)throw Error("There is no next element");
return a},prevOrNull:function(){var a;if(this.elem.previousElementSibling)a=this.elem.previousElementSibling;else for(a=this.elem.previousSibling;null!=a&&1!==a.nodeType;)a=a.previousSibling;return null==a?null:new d.Elem(a)},prev:function(){var a=this.prevOrNull();if(null==a)throw Error("There is no previous element");return a},children:function(){for(var a=this.elem.children,b=[],c=0;c<a.length;c++)1==a[c].nodeType&&b.push(a[c]);return new d.OfsysDomElemArray(b)},parent:function(){return new d.Elem(this.elem.parentNode)},
firstParentMatching:function(a){for(var b=this.elem.parentNode;null!=b;){if(d.wrap(b).is(a))return d.wrap(b);b=b.parentNode}return null},addClass:function(a){this.hasClass(a)||(this.elem.className+=" "+a);return this},removeClass:function(a){for(var b=this.elem.className.split(" "),c=[],d=0;d<b.length;d++)b[d]!=a&&c.push(b[d]);this.elem.className=c.join(" ");return this},classes:function(){return this.elem.className.split(" ")},hasClass:function(a){for(var b=this.elem.className.split(" "),c=0;c<b.length;c++)if(b[c]==
a)return!0;return!1},getAttr:function(a){return this.elem.getAttribute(a)},setAttr:function(a,b){this.elem.setAttribute(a,b);return this},removeAttr:function(a){this.elem.removeAttribute(a);return this},getStyle:function(a){var b=this._getComputedStyle(a);if(null==b||""==b)b=this.elem.style.getPropertyValue?this.elem.style.getPropertyValue(a):this.elem.style[d.util.cssToCamelCase(a)];return""===b?null:b},_getComputedStyle:function(a){if(window.getComputedStyle)return window.getComputedStyle(this.elem,
null).getPropertyValue(a);if(this.elem.currentStyle)return this.elem.currentStyle[d.util.cssToCamelCase(a)];throw Error("Unsupported");},getOwnStyle:function(a){a=this.elem.style.getPropertyValue?this.elem.style.getPropertyValue(a):this.elem.style[d.util.cssToCamelCase(a)];return""===a?null:a},setStyle:function(a,b){this.elem.style.setProperty?this.elem.style.setProperty(a,b):this.elem.style[d.util.cssToCamelCase(a)]=b;return this},setStyles:function(a){for(var b in a)this.setStyle(b,a[b]);return this},
removeStyle:function(a){if(this.elem.style.removeProperty)this.elem.style.removeProperty(a);else if(this.elem.style.removeAttribute)this.elem.style.removeAttribute(d.util.cssToCamelCase(a));else throw Error("Unsupported");return this},isChecked:function(){return this.elem.checked},setChecked:function(a){this.elem.checked=a;return this},getSelectedOption:function(){for(var a=this.getValue(),b=this.findAll("option"),c=0;c<b.length();c++)if(b.get(c).getValue()==a)return b.get(c);return null},getValue:function(){return this.elem.value},
setValue:function(a){this.elem.value=a;return this},append:function(a){this.elem.appendChild(a.elem);return this},prepend:function(a){this.elem.insertBefore(a.elem,this.elem.firstChild);return this},appendTo:function(a){a.elem.appendChild(this.elem);return this},insertAfter:function(a){a.elem.parentNode.insertBefore(this.elem,a.elem.nextSibling);return this},insertBefore:function(a){a.elem.parentNode.insertBefore(this.elem,a.elem);return this},remove:function(){this.elem.parentNode.removeChild(this.elem);
this.elem=null},detach:function(){this.elem=this.elem.parentNode.removeChild(this.elem);return this},empty:function(){this.elem.innerHTML="";return this},getText:function(){if("textContent"in this.elem)return this.elem.textContent;if("innerText"in this.elem)return this.elem.innerText;throw Error("Unsupported");},setText:function(a){if("textContent"in this.elem)this.elem.textContent=a;else if("innerText"in this.elem)this.elem.innerText=a;else throw Error("Unsupported");return this},getInnerHTML:function(){return this.elem.innerHTML},
setInnerHTML:function(a){this.elem.innerHTML=a;return this},getOuterHTML:function(){return this.elem.outerHTML},setOuterHTML:function(a){this.elem.outerHTML=a;return this},appendText:function(a){this.elem.appendChild(document.createTextNode(a));return this},appendHTML:function(a){var b=document.createDocumentFragment(),c=document.createElement("div");for(c.innerHTML=a;c.firstChild;)b.appendChild(c.firstChild);this.elem.appendChild(b);return this},clone:function(){return d.parse(this.elem.outerHTML)},
on:function(a,b,c){return d.on(this.elem,a,b,c)},removeEvent:function(a){if(this.elem.removeEventListener)this.elem.removeEventListener(a.eventType,a.fn,!1);else if(this.elem.detachEvent)this.elem.detachEvent("on"+a.eventType,a.fn);else throw Error("Unsupported");return this},trigger:function(a){if(document.createEvent){var b=document.createEvent("HTMLEvents");b.initEvent(a,!0,!0);b.eventName=a;this.elem.dispatchEvent(b)}else if(document.createEventObject)b=document.createEventObject(),this.elem.fireEvent("on"+
a,b);else throw Error("Unsupported");},getScroll:function(){return{left:this.elem.scrollLeft,top:this.elem.scrollTop}},setScrollLeft:function(a){this.elem.scrollLeft=a;return this},setScrollTop:function(a){this.elem.scrollTop=a;return this},getBounds:function(){var a=this.elem.getBoundingClientRect(),b=d.browserWindow.getScrollLeft(),c=d.browserWindow.getScrollTop();return{left:a.left+b,top:a.top+c,right:a.right+b,bottom:a.bottom+c,width:a.right==a.left?0:a.right-a.left+1,height:a.top==a.bottom?0:
a.bottom-a.top+1}},getWidth:function(){return this.elem.offsetWidth},getHeight:function(){return this.elem.offsetHeight},getCoord:function(){var a=this.elem.getBoundingClientRect(),b=d.browserWindow.getScrollLeft(),c=d.browserWindow.getScrollTop();return{left:a.left+b,top:a.top+c}},getOffsetParent:function(){return new d.Elem(this.elem.offsetParent)},getRelativeOffset:function(){return{left:this.elem.offsetLeft,top:this.elem.offsetTop}},is:function(a){if(this.elem.mozMatchesSelector)return this.elem.mozMatchesSelector(a);
if(this.elem.webkitMatchesSelector)return this.elem.webkitMatchesSelector(a);if(this.elem.msMatchesSelector)return this.elem.msMatchesSelector(a);a=this.elem.parentNode.querySelectorAll(a);for(var b=0;b<a.length;b++)if(a[b]===this.elem)return!0;return!1},focus:function(){this.elem.focus()},setShown:function(a){a?this.show():this.hide()},hide:function(){this.setAttr("domTools_previous_display",this.getStyle("display"));this.setStyle("display","none");return this},show:function(){var a=this.getAttr("domTools_previous_display");
null!=a&&""!=a&&"none"!=a?this.setStyle("display",a):this.removeStyle("display");return this},toggle:function(){"none"==this.getStyle("display")?this.show():this.hide();return this},animate:function(a){null==a&&(a={});var b=a.properties,c=a.durationMilli;null==c&&(c=400);var f=a.interpolation;null==f&&(f="swing");var e=a.onCompleteCallback,q=a.onStepCallback;a=a.extensionProperties;var k={};if(this.elem==window)k.scrollTop={get:function(){return d.browserWindow.getScrollTop()},set:function(a,b){d.browserWindow.setScrollTop(a)}},
k.scrollLeft={get:function(){return d.browserWindow.getScrollLeft()},set:function(a,b){d.browserWindow.setScrollLeft(a)}};else{var p=this;k.scrollTop={get:function(){return p.getScrollTop()},set:function(a){p.setScrollTop(a)}};k.scrollLeft={get:function(){return p.getScrollLeft()},set:function(a){p.setScrollLeft(a)}}}if(null!=a)for(var t in a)k[t]=a[t];var n=[];t=/^(-?\d+(?:\.\d+)?)([a-zA-Z]*|%)$/g;for(var h in b){a=null;if(null!=k[h])a=k[h].get();else if(a=this.getOwnStyle(h),null==a||""==a)a=this._getComputedStyle(h);
if(null===a||""===a)throw Error("No CSS val :"+h);if(a.indexOf&&(0==a.indexOf("#")||0==a.indexOf("rgb(")||0==a.indexOf("rgba("))){var g=d.util.parseColor(a),l=d.util.parseColor(b[h]);if(null!=g&&null!=l){n.push({css:h,init:g,delta:[l[0]-g[0],l[1]-g[1],l[2]-g[2],l[3]-g[3]],unit:d.util.supportsRGBA()?"rgba":"rgb"});continue}}t.lastIndex=0;g=t.exec(a);if(null==g)throw Error("Bad CSS val "+h+" : "+a);l=parseFloat(g[1]);if(isNaN(l))throw Error("Bad CSS val "+h+" : "+a);a=g[2];var m=b[h];if("string"==typeof b[h]){t.lastIndex=
0;g=t.exec(b[h]);if(null==g)throw Error("Bad CSS val "+h+" : "+b[h]);m=parseFloat(g[1]);if(isNaN(m))throw Error("Invalid target CSS "+h+" : "+b[h]);if(a!=g[2])throw Error("Cannot animate CSS "+h+" from "+a+" to "+g[2]);}n.push({css:h,init:l,delta:m-l,unit:a})}var u=d.util.getTimeStampForAnimation(),A=u,y;if("linear"==f)y=0;else if("swing"==f)y=1;else throw Error("Invalid interpolation "+f);var p=this,z=function(){A=d.util.getTimeStampForAnimation();var a=(A-u)/c;1<a&&(a=1);1==y&&(a=Math.sin((a-.5)*
Math.PI)/2+.5);for(var b=0;b<n.length;b++){var f=n[b],t;t="rgba"==f.unit?"rgba("+(f.init[0]+f.delta[0]*a|0)+","+(f.init[1]+f.delta[1]*a|0)+","+(f.init[2]+f.delta[2]*a|0)+","+(f.init[3]+f.delta[3]*a)+")":"rgb"==f.unit?"rgb("+(f.init[0]+f.delta[0]*a|0)+","+(f.init[1]+f.delta[1]*a|0)+","+(f.init[2]+f.delta[2]*a|0)+")":f.init+f.delta*a+f.unit;null!=k[f.css]?k[f.css].set(t,p):p.setStyle(f.css,t)}1>a?(window.requestAnimationFrame?window.requestAnimationFrame(z):setTimeout(z,1),null!=q&&q()):null!=e&&e()};
window.requestAnimationFrame?window.requestAnimationFrame(z):setTimeout(z,1)},fadeIn:function(a,b,c){null==a&&(a=500);var d=this;this.setStyle("opacity","0.0");"none"==this.getStyle("display")&&this.removeStyle("display");this.animate({properties:{opacity:1},durationMilli:a,interpolation:b,onCompleteCallback:function(){d.removeStyle("opacity");c&&c()}});return this},fadeOut:function(a,b,c){null==a&&(a=500);var d=this;this.setStyle("opacity","1.0");this.animate({properties:{opacity:0},durationMilli:a,
interpolation:b,onCompleteCallback:function(){d.setStyle("display","none").removeStyle("opacity");c&&c()}});return this},fadeToggle:function(){"none"!=this.getStyle("display")?this.fadeOut():this.fadeIn();return this},slideDown:function(a,b){null==a&&(a=500);var c=this.getStyle("height");"auto"==c&&(this.setStyle("visibility","hidden"),"none"==this.getStyle("display")&&this.removeStyle("display"),c=this.getHeight()-parseInt(this.getStyle("padding-top"))-parseInt(this.getStyle("padding-bottom"))-parseInt(this.getStyle("border-top-width"))-
parseInt(this.getStyle("border-bottom-width")));this.setStyle("height","0px").setStyle("visibility","visible");c=parseInt(c);this.elem.style.height="0px";this.setStyle("overflow","hidden");"none"==this.getStyle("display")&&this.removeStyle("display");var d=this.getStyle("padding-top"),e=this.getStyle("padding-bottom");this.setStyle("padding-top","0px").setStyle("padding-bottom","0px");this.animate({properties:{height:c,"padding-top":d,"padding-bottom":e},durationMilli:a,interpolation:b});return this},
slideUp:function(a,b){null==a&&(a=500);var c=this.getStyle("padding-top"),d=this.getStyle("padding-bottom"),e=this.elem.offsetHeight-parseInt(c)-parseInt(d)-parseInt(this.getStyle("border-top-width"))-parseInt(this.getStyle("border-bottom-width"));this.elem.style.height=e+"px";this.elem.style.overflow="hidden";var h=this;this.animate({properties:{height:0,"padding-top":0,"padding-bottom":0},durationMilli:a,interpolation:b,onCompleteCallback:function(){h.elem.style.display="none";h.setStyle("padding-top",
c).setStyle("padding-bottom",d).setStyle("height",e+"px")}});return this},slideToggle:function(){"none"!=this.getStyle("display")?this.slideUp():this.slideDown();return this},scaleUp:function(a,b,c){null==a&&(a=500);null==b&&(b=0);null==c&&(c=1);var d=this;this.setStyle("transform","scale("+b+")").show();this.animate({properties:{transform_scale:c},durationMilli:a,onCompleteCallback:function(){d.removeStyle("transform")},extensionProperties:{transform_scale:{get:function(){return b},set:function(a,
b){b.setStyle("transform","scale("+a+")")}}}});return this},scaleDown:function(a,b,c){null==a&&(a=500);null==b&&(b=1);null==c&&(c=0);var d=this;this.setStyle("transform","scale("+b+")");this.animate({properties:{transform_scale:c},durationMilli:a,onCompleteCallback:function(){d.removeStyle("transform");d.hide()},extensionProperties:{transform_scale:{get:function(){return b},set:function(a,b){b.setStyle("transform","scale("+a+")")}}}});return this}};d.OfsysDomElemArray=h;h.prototype={get:function(a){if(null==
this.elems[a])throw Error("No element at index : "+a);return new d.Elem(this.elems[a])},first:function(){if(0==this.elems.length)throw Error("Empty");return new d.Elem(this.elems[0])},last:function(){if(0==this.elems.length)throw Error("Empty");return new d.Elem(this.elems[this.elems.length-1])},length:function(){return this.elems.length},addClass:function(a){for(var b=0;b<this.elems.length;b++)d.wrap(this.elems[b]).addClass(a);return this},removeClass:function(a){for(var b=0;b<this.elems.length;b++)d.wrap(this.elems[b]).removeClass(a);
return this},setAttr:function(a,b){for(var c=0;c<this.elems.length;c++)d.wrap(this.elems[c]).setAttr(a,b);return this},removeAttr:function(a){for(var b=0;b<this.elems.length;b++)d.wrap(this.elems[b]).removeAttr(a);return this},setStyle:function(a,b){for(var c=0;c<this.elems.length;c++)d.wrap(this.elems[c]).setStyle(a,b);return this},removeStyle:function(a){for(var b=0;b<this.elems.length;b++)d.wrap(this.elems[b]).removeStyle(a);return this},setProp:function(a,b){for(var c=0;c<this.elems.length;c++)d.wrap(this.elems[c]).setProp(a,
b);return this},setVal:function(a){for(var b=0;b<this.elems.length;b++)d.wrap(this.elems[b]).setVal(a);return this},remove:function(){for(var a=0;a<this.elems.length;a++)d.wrap(this.elems[a]).remove();return this},empty:function(){for(var a=0;a<this.elems.length;a++)d.wrap(this.elems[a]).empty();return this},setText:function(a){for(var b=0;b<this.elems.length;b++)d.wrap(this.elems[b]).setText(a);return this},setInnerHTML:function(a){for(var b=0;b<this.elems.length;b++)d.wrap(this.elems[b]).setInnerHTML(a);
return this},setOuterHTML:function(a){for(var b=0;b<this.elems.length;b++)d.wrap(this.elems[b]).setOuterHTML(a);return this},appendText:function(a){for(var b=0;b<this.elems.length;b++)d.wrap(this.elems[b]).appendText(a);return this},appendHTML:function(a){for(var b=0;b<this.elems.length;b++)d.wrap(this.elems[b]).appendHTML(a);return this},on:function(a,b,c){for(var f=0;f<this.elems.length;f++)d.wrap(this.elems[f]).on(a,b,c);return this},trigger:function(a){for(var b=0;b<this.elems.length;b++)d.wrap(this.elems[b]).trigger(a);
return this},setScrollLeft:function(a){for(var b=0;b<this.elems.length;b++)d.wrap(this.elems[b]).setScrollLeft(a);return this},setScrollTop:function(a){for(var b=0;b<this.elems.length;b++)d.wrap(this.elems[b]).setScrollTop(a);return this},hide:function(){for(var a=0;a<this.elems.length;a++)d.wrap(this.elems[a]).hide();return this},show:function(){for(var a=0;a<this.elems.length;a++)d.wrap(this.elems[a]).show();return this},toggle:function(){for(var a=0;a<this.elems.length;a++)d.wrap(this.elems[a]).toggle();
return this}};d.util={};d.util.cssToCamelCase=function(a){return a.replace(/-+(.)?/g,function(a,c){return c?c.toUpperCase():""})};d.util.supportsRGBA=function(){var a=d.create("script");try{a.elem.style.color="rgba(0, 0, 0, 0.5)"}catch(b){return!1}return!0};d.util.supportsTransform=function(){return"transform"in d.create("div").elem.style};d.util.getTimeStampForAnimation=function(){return window.performance&&window.performance.now?window.performance.now():window.performance&&window.performance.webkitNow?
window.performance.webkitNow():(new Date).getTime()};d.util.parseColor=function(a,b){a=l.util.string.trim(a).toLowerCase();var c=a.match(/^#([0-9a-f]{3})$/i);return c?(c=c[1],[17*parseInt(c.charAt(0),16),17*parseInt(c.charAt(1),16),17*parseInt(c.charAt(2),16),1]):(c=a.match(/^#([0-9a-f]{6})$/i))?(c=c[1],[parseInt(c.substr(0,2),16),parseInt(c.substr(2,2),16),parseInt(c.substr(4,2),16),1]):(c=a.match(/^rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+.*\d*)\s*\)$/i)||a.match(/^rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i))?
[parseInt(c[1]),parseInt(c[2]),parseInt(c[3]),void 0===c[4]?1:parseFloat(c[4])]:(c=a.match(/^rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i))?[parseInt(c[1]),parseInt(c[2]),parseInt(c[3]),1]:b};d.util.cancelEvent=function(a){a.preventDefault&&a.preventDefault();a.stopPropagation&&a.stopPropagation();l.util.isIE8OrOlder()&&(a.cancelBubble=!0,a.returnValue=!1)};d.util._onInputEventCompatibility=function(a,b){"onpropertychange"in a.elem&&(a.elem.onpropertychange=b);a.on("keyup",{input:a},b)};d.util.makeUnselectable=
function(a){if(l.util.isIE9OrOlder()&&null!=a.tagName){var b=a.tagName.toLowerCase();if("input"!=b&&"select"!=b&&"textarea"!=b)for(1==a.nodeType&&a.setAttribute("unselectable","on"),a=a.firstChild;a;)d.util.makeUnselectable(a),a=a.nextSibling}};d.util.selectNothing=function(){if(window.getSelection)window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges();else if(document.selection)try{document.selection.empty()}catch(a){}};
d.id=function(a){return d._selectByID(a,document)};d.body=function(){return d.wrap(document.body)};d.select1=function(a){return d._select1(a,document)};d.selectAll=function(a){return d._selectAll(a,document)};d.selectAllByClass=function(a){return d._selectAllByClass(a,document)};d.create=function(a,b){var c=document.createElement(a),f=new d.Elem(c);if(null!=b){for(var e in b)("style"!=e||"style"==e&&null!=e.toUpperCase)&&c.setAttribute(e,b[e]);if(null!=b.style&&null==b.style.toUpperCase)for(e in c=
b.style,c)f.setStyle(e,c[e])}return f};d.nsCreate=function(a,b,c){if(null==document.createElementNS)throw Error("Namespaces not supported by browser");b=document.createElementNS(a,b);a=new d.Elem(b);if(null!=c){for(var f in c)("style"!=f||"style"==f&&null!=f.toUpperCase)&&b.setAttribute(f,c[f]);if(null!=c.style&&null==c.style.toUpperCase)for(f in c=c.style,c)a.setStyle(f,c[f])}return a};d.parse=function(a){var b=document.createElement("div");b.innerHTML=a;if(1<b.childNodes.length)throw Error("Multiple nodes in html fragment");
return new d.Elem(b.firstChild)};d.wrap=function(a){return new d.Elem(a)};var e=!1;d.onLoad=function(a){if(e)a();else if(window.addEventListener)window.addEventListener("load",a,!1);else if(window.attachEvent)window.attachEvent("onload",a);else throw Error("Not supported");};if(window.addEventListener)window.addEventListener("load",function(){e=!0},!1);else if(window.attachEvent)window.attachEvent("onload",function(){e=!0});else throw Error("Unsupported");d.onReady=function(a){if("complete"==document.readyState||
"interactive"==document.readyState)a();else if(document.addEventListener)document.addEventListener("DOMContentLoaded",a,!1);else if(document.attachEvent)document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&a()});else throw Error("Not supported");};d.on=function(a,b,c,f){var e,h;null==f?h=e=c:(e=f,h=function(a){e(a,c)});if(!("input"!=b||"oninput"in a&&!l.util.isIE9OrOlder()))return d.util._onInputEventCompatibility(d.wrap(a),h);if(null==f)if(a.addEventListener)a.addEventListener(b,
e,!1);else if(a.attachEvent)a.attachEvent("on"+b,e);else throw Error("Unsupported");else if(a.addEventListener)a.addEventListener(b,h,!1);else if(a.attachEvent)a.attachEvent("on"+b,h);else throw Error("Unsupported");return{eventType:b,fn:h}};d._selectAll=function(a,b){var c=b.querySelectorAll(a);return new d.OfsysDomElemArray(l.util.convertToArray(c,0))};d._selectAllByClass=function(a,b){var c;if(b.getElementsByClassName)c=b.getElementsByClassName(a);else if(b.querySelectorAll)c=b.querySelectorAll("."+
a);else throw Error("Unsupported");return new d.OfsysDomElemArray(l.util.convertToArray(c,0))};d._select1=function(a,b){var c=b.querySelectorAll(a);if(1==c.length)return new d.Elem(c[0]);if(0==c.length)throw Error("Element(s) not found : "+a);throw Error("Too many element(s) found for "+a+" : "+c.length);};d._selectByID=function(a,b){var c="getElementById"in b?b.getElementById(a):b.querySelector("#"+a);if(null==c)throw Error("Element not found : "+a);return new d.Elem(c)};d.svg={create:function(a,
b){return d.nsCreate("http://www.w3.org/2000/svg",a,b)}};d.browserWindow={getSize:function(){var a=1080,b=800;window.innerHeight?(a=window.innerWidth,b=window.innerHeight):window.document.documentElement.clientHeight?(a=window.document.documentElement.clientWidth,b=window.document.documentElement.clientHeight):window.document.body.clientHeight&&(a=window.document.body.clientWidth,b=window.document.body.clientHeight);return{width:a,height:b}},getScrollTop:function(){return void 0!==window.pageYOffset?
window.pageYOffset:"CSS1Compat"===(document.compatMode||"")?document.documentElement.scrollTop:document.body.scrollTop},setScrollTop:function(a){window.scrollTo(d.browserWindow.getScrollLeft(),a)},getScrollLeft:function(){return void 0!==window.pageXOffset?window.pageXOffset:"CSS1Compat"===(document.compatMode||"")?document.documentElement.scrollLeft:document.body.scrollLeft},setScrollLeft:function(a){window.scrollTo(a,d.browserWindow.getScrollTop())},getScrollWidth:function(){return document.body.scrollWidth},
getScrollHeight:function(){return document.body.scrollHeight}}})(window.ofsysGenericClientForm.dom);null==window.ofsysGenericClientForm&&(window.ofsysGenericClientForm={});null==window.ofsysGenericClientForm.lightbox&&(window.ofsysGenericClientForm.lightbox={});
(function(d){var m=window.ofsysGenericClientForm,h=m.dom,l=m.util,m=l.classes.DeclareClassWithVariables,e={};d.ShowDivInLightbox=function(b,c){null==e[b]&&(e[b]=new a(c),e[b].GetContent().append(h.id(b).detach().show()));e[b].Show()};h.on(window,"resize",function(a){a=h.browserWindow.getSize();for(var b in e)e[b].OnWindowResized(a)});var a=m({variables:{m_Background:null,m_LightboxDiv:null,m_ContentDiv:null,m_CloseButton:null},methods:{init:function(a){null==a&&(a={});var b=l.isIE8OrOlder();this.m_Background=
h.create("div",{"class":"DialogInsightLightBoxBackground"+(b?" DialogInsightLightBoxBackground_OldIE":""),style:{display:"none"}});this.m_LightboxDiv=h.create("div",{"class":"DialogInsightLightBox",style:{width:(a.width||600)+"px"}});this.m_ContentDiv=h.create("div");this.m_CloseButton=h.create("div",{"class":"DialogInsightLightBoxCloseButton"});b=h.browserWindow.getSize().height;this.m_ContentDiv.setStyles({overflow:"auto","max-height":b-100+"px"});h.body().append(this.m_Background.append(this.m_LightboxDiv.append(this.m_ContentDiv).append(this.m_CloseButton)));
var d=this;this.m_CloseButton.on("click",function(b){d.Hide();a.hideCallback&&a.hideCallback.call(d)})},Show:function(){var a=h.browserWindow.getSize().height;this.m_ContentDiv.setStyles({overflow:"auto","max-height":a-100+"px"});var a=h.util.supportsRGBA(),c=h.util.supportsTransform();if(a=a&&c)this.m_LightboxDiv.hide().setStyle("opacity","0"),this.m_Background.setStyle("background-color","rgba(0,0,0,0.01)");this.m_Background.show();a&&(this.m_Background.animate({properties:{"background-color":"rgba(0,0,0,0.5)"},
durationMilli:500}),this.m_LightboxDiv.setStyle("transform","scale(0)").show().scaleUp(500,.5,1).fadeIn(500))},Hide:function(){var a=h.util.supportsRGBA(),c=h.util.supportsTransform(),d=this;a&&c?(this.m_LightboxDiv.scaleDown(500,1,.5).fadeOut(500),this.m_Background.animate({properties:{"background-color":"rgba(0,0,0,0.01)"},durationMilli:500,onCompleteCallback:function(){d.m_Background.hide().removeStyle("background-color")}})):this.m_Background.hide()},GetContent:function(){return this.m_ContentDiv},
OnWindowResized:function(a){this.m_ContentDiv.setStyles({overflow:"auto","max-height":a.height-100+"px"})}}});d.LightboxPopup=a})(window.ofsysGenericClientForm.lightbox);null==window.ofsysGenericClientForm&&(window.ofsysGenericClientForm={});null==window.ofsysGenericClientForm.datepicker&&(window.ofsysGenericClientForm.datepicker={});
(function(d){function m(a,b){var c=new Date(a.getTime());c.setDate(c.getDate()+b);return c}function h(a,b){var c=new Date(a.getTime());c.setMonth(c.getMonth()+b);return c}var l=window.ofsysGenericClientForm,e=l.dom,a=l.util,b=a.classes.DeclareClassWithVariables;d.ShowDatePickerForInput=function(b,c,d,k){b=e.id(b);var f=null;null!=b.getValue()&&0<b.getValue().length&&(f=a.datetime.parseOFSYSDateTime(b.getValue()));new l.datepicker.DatePickerPopup({lang:d,year:null==f?null:f.getFullYear(),month:null==
f?null:f.getMonth(),day:null==f?null:f.getDate(),showTimePicker:c,hours:null==f?null:f.getHours(),minutes:null==f?null:f.getMinutes(),anchor:b,callback:function(b){var d=b.getFullYear()+"."+a.prefixZeros(b.getMonth()+1,2)+"."+a.prefixZeros(b.getDate(),2);c&&(d+=" "+a.prefixZeros(b.getHours(),2)+":"+a.prefixZeros(b.getMinutes(),2));k(d)}})};var c=null,b=b({variables:{m_CurrMonth:-1,m_CurrYear:-1,m_SelectedDate:null,m_Options:null,m_Callback:null,m_Lang:null,m_Div:null,m_txtTimePicker:null,m_Table:null},
methods:{init:function(a){var b=this;if(null!=c)try{c.Close(),c=null}catch(w){}c=this;null==a&&(a={});this.m_Options=a;this.m_Callback=a.callback;this.m_Div=e.create("div",{"class":"DialogInsightDatePicker"});this.m_txtTimePicker=null;this.m_Div.on("mouseleave",function(a){b.Close()});this.m_Div.on("click",function(a){a.target!=b.m_Div.elem&&a.srcElement!=b.m_Div.elem||b.Close()});this.m_Table=null;this.m_Lang=null==a.lang?"en":a.lang;this.m_SelectedDate=null!=a.year&&null!=a.month&&null!=a.day?{year:a.year,
month:a.month,day:a.day}:null;null==a.year&&(a.year=(new Date).getFullYear());null==a.month&&(a.month=(new Date).getMonth());this.m_CurrYear=a.year;this.m_CurrMonth=a.month;this.Render();e.body().append(this.m_Div);var d=e.browserWindow.getScrollTop(),k=e.browserWindow.getSize().height;a=a.anchor.getBounds();var p=a.left,f=a.top+a.height-1,h=this.m_Div.getHeight()-100;f-d+h>k-25?this.m_Div.setStyles({left:p-100+"px",bottom:k-a.top-100-1+"px"}):this.m_Div.setStyles({left:p-100+"px",top:f-100+"px"})},
Render:function(){var b=this;if(0>this.m_CurrMonth||11<this.m_CurrMonth)throw Error("Invalid month");var c,d,k,p;"fr-CA"==this.m_Lang||"fr-FR"==this.m_Lang?(c="Dim Lun Mar Mer Jeu Ven Sam".split(" "),d="Janvier F&eacute;vrier Mars Avril Mai Juin Juillet Ao&ucirc;t Septembre Octobre Novembre D&eacute;cembre".split(" "),k="Fermer",p="Heure : "):(c="Sun Mon Tue Wed Thu Fri Sat".split(" "),d="January February March April May June July August September October November December".split(" "),k="Close",p=
"Time : ");this.m_Div.empty();var t=e.create("div",{"class":"DialogInsightDatePickerContent"});this.m_Div.append(t);for(var n=new Date(this.m_CurrYear,this.m_CurrMonth,1),l=m(h(n,1),-1),g=n;0!=g.getDay();)g=m(g,-1);for(var x=l;6!=x.getDay();)x=m(x,1);var v,u;t.append(e.create("div",{"class":"DialogInsightDatePickerHeader"}).append(e.create("div",{"class":"DialogInsightDatePickerMonth"}).setInnerHTML(d[this.m_CurrMonth])).append(u=e.create("input",{type:"text",maxlength:"4","class":"DialogInsightDatePickerYear"}).setValue(this.m_CurrYear)).append(d=
e.create("span",{"class":"DialogInsightDatePickerPrev"}).setText("<")).append(v=e.create("span",{"class":"DialogInsightDatePickerNext"}).setText(">")));d.on("click",function(a){b.btnPrevOnClick()});v.on("click",function(a){b.btnNextOnClick()});u.on("focus",function(a){try{u.elem.select()}catch(y){}});u.on("blur",function(a){b.OnChangeYear(u)});u.on("keydown",function(a){13==a.keyCode&&b.OnChangeYear(u)});u.on("keyup",function(a){48<=a.keyCode&&57>=a.keyCode&&4==u.getValue().length&&b.OnChangeYear(u)});
this.m_Table=e.create("table",{"class":"DialogInsightDatePickerMonthTbl"});d=e.create("tr");this.m_Table.append(d);for(v=0;v<c.length;v++)d.append(e.create("th").setText(c[v]));c=new Date;t.append(this.m_Table);d=e.create("tr");for(this.m_Table.append(d);g<=x;)d.append(v=e.create("td").setText(g.getDate())),(g<n||g>l)&&v.addClass("OutOfMonth"),null!=this.m_SelectedDate&&g.getFullYear()==this.m_SelectedDate.year&&this.m_SelectedDate.month==g.getMonth()&&this.m_SelectedDate.day==g.getDate()&&v.addClass("SelectedDate"),
g.getFullYear()==c.getFullYear()&&g.getMonth()==c.getMonth()&&g.getDate()==c.getDate()&&v.addClass("Today"),6==g.getDay()&&(d=e.create("tr"),this.m_Table.append(d)),v.on("click",{date:g},function(a,c){b.m_SelectedDate={year:c.date.getFullYear(),month:c.date.getMonth(),day:c.date.getDate()};b.OnSelectDate(!0,!1)}),g=m(g,1);t.append(n=e.create("div",{"class":"DialogInsightDatePickerFooter"}));!0===this.m_Options.showTimePicker&&(n.append(e.create("div",{"class":"DialogInsightTimePickerContainer"}).append(e.create("span").setText(p)).append(this.m_txtTimePicker=
e.create("input",{type:"text","class":"DialogInsightTimePickerTxtbox",placeholder:"HH:mm"}))),null!=this.m_Options.hours||null!=this.m_Options.minutes?(p=this.m_Options.minutes||0,this.m_txtTimePicker.setValue(a.prefixZeros(this.m_Options.hours||0,2)+":"+a.prefixZeros(p,2))):this.m_txtTimePicker.setValue("00:00"),this.m_txtTimePicker.on("blur",function(a){b.OnSelectDate(!1,!0)}),this.m_txtTimePicker.on("keyup",function(a){13==a.keyCode?b.OnSelectDate(!1,!0):(a=b.m_txtTimePicker.getValue(),5==a.length&&
":"==a[2]?b.OnSelectDate(!1,!0):4==a.length&&":"==a[1]&&b.OnSelectDate(!1,!0))}));n.append(k=e.create("div",{"class":"DialogInsightDatePickerCloseBtn"}).setText(k));k.on("click",function(a){!0===b.m_Options.showTimePicker&&b.OnSelectDate(!0,!0);b.Close()});t.addClass("DialogInsightUnselectable");e.util.makeUnselectable(t.elem)},OnChangeYear:function(b){var c=null;try{c=a.parseInt(b.getValue())}catch(q){}null!=c&&1900<c&&3E3>c?(this.m_CurrYear=c,this.Render()):b.setValue(this.m_CurrYear)},OnSelectDate:function(b,
c){var d=0,k=0;if(!0===this.m_Options.showTimePicker){var e=a.string.trim(this.m_txtTimePicker.getValue());0<e.length?(e=a.datetime.parseOFSYSTime(e),null==e?this.m_txtTimePicker.addClass("Error"):(d=this.m_Options.hours=e.HH,k=this.m_Options.minutes=e.mm,this.m_txtTimePicker.removeClass("Error"))):c&&(d=this.m_Options.hours=0,k=this.m_Options.minutes=0,this.m_txtTimePicker.removeClass("Error"))}null!=this.m_SelectedDate&&null!=this.m_SelectedDate.year&&null!=this.m_SelectedDate.month&&null!=this.m_SelectedDate.day&&
!1!==this.m_Callback(new Date(this.m_SelectedDate.year,this.m_SelectedDate.month,this.m_SelectedDate.day,d,k,0))&&(!0===this.m_Options.showTimePicker?b&&this.Render():this.Close())},Close:function(){null!=this.m_Div.elem&&this.m_Div.remove();c=null},btnPrevOnClick:function(){--this.m_CurrMonth;0>this.m_CurrMonth&&(this.m_CurrMonth=11,--this.m_CurrYear);this.Render()},btnNextOnClick:function(){this.m_CurrMonth+=1;11<this.m_CurrMonth&&(this.m_CurrMonth=0,this.m_CurrYear+=1);this.Render()}}});d.DatePickerPopup=
b})(window.ofsysGenericClientForm.datepicker);null==window.ofsysGenericClientForm&&(window.ofsysGenericClientForm={});null==window.ofsysGenericClientForm.clientBaseForm&&(window.ofsysGenericClientForm.clientBaseForm={});null==window.ofsysGenericClientForm.baseFormUtils&&(window.ofsysGenericClientForm.baseFormUtils={});null==window.DI&&(window.DI={});null==DI.Forms&&(DI.Forms={});null==DI.Forms.Generic&&(DI.Forms.Generic=window.ofsysGenericClientForm);
null==DI.Forms.Generic.Client&&(DI.Forms.Generic.Client=window.ofsysGenericClientForm.clientBaseForm);null==DI.Forms.Generic.Dom&&(DI.Forms.Generic.Dom=window.ofsysGenericClientForm.dom);null==DI.Forms.Generic.Lightbox&&(DI.Forms.Generic.Lightbox=window.ofsysGenericClientForm.lightbox);null==DI.Validators&&(DI.Validators={});null==DI.Validators.Libraries&&(DI.Validators.Libraries={});
(function(d){function m(a){a.height=e.body().getHeight()+parseInt(e.body().getStyle("margin-top"))+parseInt(e.body().getStyle("margin-bottom"));if(f)try{window.parent.postMessage("di:"+JSON.stringify(a),"*")}catch(p){console.error(p,"Postmessage failed")}}function h(a,b,c){var d=c.getHeight();c.setStyle("min-height",d+"px");c.removeClass("DialogInsightLoading");var k;0==(navigator.language||navigator.userLanguage).indexOf("fr")?(d="Erreur inattendue",k="R\u00e9essayez plus tard et, si le probl\u00e8me persiste, communiquez avec le service \u00e0 la client\u00e8le."):
(d="Unexpected error",k="Try again later and if the problem continues, contact client support.");c.empty().append(e.create("div",{style:{"font-weight":"bold",color:"#990000"}}).setText(d)).append(e.create("div",{style:{"padding-top":"6px",color:"#990000"}}).setText(k)).append(e.create("div",{style:{"padding-top":"20px",color:"#999999","max-height":"200px",overflow:"auto","font-family":"monospace","white-space":"pre-wrap"}}).setText(a+"\n"+b));c.show();f&&m({event:"internalError"})}var l=window.ofsysGenericClientForm,
e=l.dom,a=l.util,b=l.baseFormUtils,c=a.classes.DeclareClassWithVariables,f="1"==a.getURLParameters().DI_Intercept;d.HandleInternalError=h;var r={};d.InitForm=function(a){if(null!=r[a.formIdent])throw Error("Form already exists: "+a.formIdent);try{var b=e.id(a.idBaseDiv);r[a.formIdent]=new q(b,a)}catch(t){return window.console&&console.error(t," | stack = ",t.stack),h("[InitForm] Uncaught exception: "+t,t.stack,b),null}a.visible&&b.show();return r[a.formIdent]};d.GetForm=function(a){if(null==r[a])throw Error("Form does not exist: "+
a);return r[a]};var q=c({variables:{m_FormDefinition:null,m_BaseDiv:null,m_OnResizeCallbacks:null,m_LastNotifiedHeight:null,m_GotInvisibleRecaptcha:!1},methods:{init:function(c,d){var k=this;this.m_FormDefinition=d;this.m_BaseDiv=c;this.m_OnResizeCallbacks=[];this.m_LastNotifiedHeight=null;for(var p=a.isIE8OrOlder(),h=0;h<this.m_FormDefinition.fields.length;h++){var g=this.m_FormDefinition.fields[h];if("radio"==g.inputType){g.input=[];for(var l=e.selectAll("input[name="+g.id+"]"),q=0;q<l.length();q++){var r=
l.get(q);g.input.push(r);r.on("change",{currField:g},function(a,b){k.PerformLiveValidation(b.currField)});r.on("keydown",{currField:g},function(a,b){13==a.keyCode&&e.util.cancelEvent(a)})}}else if("recaptcha"==g.inputType)g.input=e.id(g.id),b.RecaptchaHelper.WhenRecaptchaLoaded({currField:g,formDef:this.m_FormDefinition},function(a){a.currField.recaptchaWidgetID=grecaptcha.render(a.currField.id,{sitekey:a.formDef.recaptchaSiteKey||"missing-key",callback:function(b){k.PerformLiveValidation(a.currField)}})});
else if("invisible_recaptcha"==g.inputType)g.input=e.id(g.id),b.RecaptchaHelper.WhenRecaptchaLoaded({currField:g,formDef:this.m_FormDefinition},function(b){b.currField.recaptchaWidgetID=grecaptcha.render(b.currField.id,{sitekey:b.formDef.recaptchaSiteKey||"missing-key",size:"invisible",callback:a.methodRef(k,k.OnInvisibleRecaptchaReady)})}),this.m_GotInvisibleRecaptcha=!0;else if("checkbox"==g.inputType)g.input=e.id(g.id),g.input.on("change",{currField:g},function(a,b){k.PerformLiveValidation(b.currField)}),
p&&(g.input.on("click",{currField:g},function(a,b){setTimeout(function(){k.PerformLiveValidation(b.currField)},0)}),g.input.on("blur",{currField:g},function(a,b){setTimeout(function(){k.PerformLiveValidation(b.currField)},0)})),g.input.on("keydown",{currField:g},function(a,b){13==a.keyCode&&e.util.cancelEvent(a)});else if("select"==g.inputType)g.input=e.id(g.id),l=g.input.getSelectedOption(),null!=l&&(l=l.getOwnStyle("color"),null!=l&&""!=l?g.input.setStyle("color",l):g.input.removeStyle("color")),
g.input.on("change",{currField:g},function(a,b){k.PerformLiveValidation(b.currField);var c=b.currField.input,d=c.getSelectedOption();null!=d&&(d=d.getOwnStyle("color"),null!=d&&""!=d?c.setStyle("color",d):c.removeStyle("color"))});else if(g.input=e.id(g.id),b.InitSimulatedPlaceholder(g.input),g.input.on("blur",{currField:g},function(a,b){k.PerformLiveValidation(b.currField)}),"textarea"!=g.inputType)g.input.on("keydown",function(a){13==a.keyCode&&e.util.cancelEvent(a)});null!=this.m_FormDefinition.fieldValues&&
null!=this.m_FormDefinition.fieldValues[g.name]&&this.SetFieldValue(g,this.m_FormDefinition.fieldValues[g.name])}f&&(m({event:"init"}),e.onLoad(function(){m({event:"onload"})}),this.m_BaseDiv.on("keydown",function(a){27==a.keyCode&&m({event:"keydown_esc"})}));this.NotifySizeChange()},OnInvisibleRecaptchaReady:function(){},PerformLiveValidation:function(a){try{var b=this.GetFieldValue(a);this.ClearInlineErrorForField(a);if(null!=a.validators&&0<a.validators.length)for(var c=0;c<a.validators.length;c++){var d=
this.RunValidator(b,a.validators[c],a);if("error"==d.status){this.DisplayInlineError(d.errorMessage,a);break}null!=d.normalizedValue&&d.normalizedValue!==b&&this.SetFieldValue(a,d.normalizedValue)}f&&m({event:"liveValidation"});this.NotifySizeChange()}catch(w){window.console&&console.error(w," | stack = ",w.stack),this.InternalError("[Submit] Uncaught exception: "+w,w.stack)}},GetFieldValue:function(b){if("checkbox"==b.inputType)return b.input.isChecked();if("radio"==b.inputType){for(var c=0;c<b.input.length;c++)if(b.input[c].isChecked())return b.input[c].getAttr("value");
return null}if("recaptcha"==b.inputType||"invisible_recaptcha"==b.inputType)return null==b.recaptchaWidgetID||null==window.grecaptcha?null:grecaptcha.getResponse(b.recaptchaWidgetID);b=b.input.getValue();null!=b&&(b=a.string.trim(b));return b},SetFieldValue:function(b,c){if("checkbox"==b.inputType)!0===c||1===c||"true"===c||"1"===c||"True"===c?b.input.setChecked(!0):!1===c||0===c||"false"===c||"0"===c||"False"===c||null==c?b.input.setChecked(!1):(b.input.setChecked(!1),window.console&&console.warn("Invalid value for checkbox: ",
c));else if("radio"==b.inputType)for(var d=0;d<b.input.length;d++)b.input[d].getAttr("value")==c?b.input[d].setChecked(!0):b.input[d].setChecked(!1);else if("recaptcha"!=b.inputType&&"invisible_recaptcha"!=b.inputType)if("select"==b.inputType)b.input.setValue(c),d=b.input.getSelectedOption(),null!=d&&(d=d.getOwnStyle("color"),null!=d&&""!=d?b.input.setStyle("color",d):b.input.removeStyle("color"));else{if(null!=c&&""!=c&&("date"==b.inputType||"datetime"==b.inputType)&&(d=l.util.datetime.parseOFSYSDateTime(c),
null!=d)){var e=d.getFullYear()+"."+a.prefixZeros(d.getMonth()+1,2)+"."+a.prefixZeros(d.getDate(),2);"datetime"==b.inputType&&(e+=" "+a.prefixZeros(d.getHours(),2)+":"+a.prefixZeros(d.getMinutes(),2));c=e}null==c?b.input.setValue(""):b.input.setValue(c);b.input.hasClass("DialogInsightInputWithPlaceholder")&&(d=b.input.firstParentMatching(".DialogInsightInputWithPlaceholderContainer"),null!=d&&(null!=c&&0<c.length?d.addClass("PlaceholderInputHasText"):d.removeClass("PlaceholderInputHasText")))}this.PerformLiveValidation(b)},
InternalError:function(a,b){h(a,b,this.m_BaseDiv)},GetFieldDefByName:function(a){for(var b=0;b<this.m_FormDefinition.fields.length;b++)if(this.m_FormDefinition.fields[b].name==a)return this.m_FormDefinition.fields[b];return null},GetFieldDefByInputID:function(a){for(var b=0;b<this.m_FormDefinition.fields.length;b++)if(this.m_FormDefinition.fields[b].id==a)return this.m_FormDefinition.fields[b];return null},DisplayGlobalError:function(a){e.id(this.m_FormDefinition.idBaseDiv+"_globalErrors").append(e.create("div").appendHTML(a));
window.location.hash="#"+this.m_FormDefinition.idBaseDiv+"_globalErrors_anchor";setTimeout(function(){window.location.hash="#_"},500)},DisplayInlineError:function(a,b){var c=e.id(b.id+"_errors");null!=b.inputType&&"textarea"!=b.inputType&&"select"!=b.inputType&&"date"!=b.inputType&&"datetime"!=b.inputType||b.input.addClass("DialogInsightFieldInError");c.empty().append(e.create("div",{"class":"DialogInsightErrorContents"}).appendHTML(a))},ClearInlineErrorForField:function(a){e.id(a.id+"_errors").empty();
null!=a.inputType&&"textarea"!=a.inputType&&"select"!=a.inputType&&"date"!=a.inputType&&"datetime"!=a.inputType||a.input.removeClass("DialogInsightFieldInError")},ClearAllErrors:function(){e.id(this.m_FormDefinition.idBaseDiv+"_globalErrors").empty();for(var a=0;a<this.m_FormDefinition.fields.length;a++)this.ClearInlineErrorForField(this.m_FormDefinition.fields[a]);this.m_BaseDiv.findAll(".DialogInsightFieldInError").removeClass("DialogInsightFieldInError")},RunValidator:function(b,c,d){if((null==
b||0==b.length)&&"required"!=c)return{status:"success"};var e=DI.Validators.Libraries.GetValidator(c);if(null==e)throw Error("Unknown validator: "+c);b=e.fn(b,d);"success"!=b.status&&(c=null,null!=d.errorMessages&&null!=d.errorMessages[b.errorCode]&&(c=d.errorMessages[b.errorCode]),null==c&&null!=this.m_FormDefinition.errorMessages[b.errorCode]&&(c=this.m_FormDefinition.errorMessages[b.errorCode]),null==c&&null!=this.m_FormDefinition.errorMessages.general&&(c=this.m_FormDefinition.errorMessages.general),
null==c&&(c="Error"),c=a.string.formatTemplate(c,{"{0}":d.lbl}),"interval"==b.errorCode?c=a.string.formatTemplate(c,{"{1}":d.min||0,"{2}":d.max||0}):"min"==b.errorCode?c=a.string.formatTemplate(c,{"{1}":d.min||0}):"max"==b.errorCode&&(c=a.string.formatTemplate(c,{"{1}":d.max||0})),b.errorMessage=c);return b},OnResize:function(a){this.m_OnResizeCallbacks.push(a)},NotifySizeChange:function(){if(0!=this.m_OnResizeCallbacks.length){var a=this.m_BaseDiv.getHeight()|0;if(a!=this.m_LastNotifiedHeight){this.m_LastNotifiedHeight=
a;for(var b=0;b<this.m_OnResizeCallbacks.length;b++)this.m_OnResizeCallbacks[b](a)}}},GetValuesAndValidate:function(){this.ClearAllErrors();this.NotifySizeChange();for(var a={},b=0;b<this.m_FormDefinition.fields.length;b++){var c=this.m_FormDefinition.fields[b],d=this.GetFieldValue(c);a[c.name]=""===d?null:d}d=!1;for(b=0;b<this.m_FormDefinition.fields.length;b++)if(c=this.m_FormDefinition.fields[b],null!=c.validators&&0<c.validators.length)for(var e=0;e<c.validators.length;e++){var h=this.RunValidator(a[c.name],
c.validators[e],c);if("success"!=h.status){d=!0;this.DisplayInlineError(h.errorMessage,c);break}null!=h.normalizedValue&&h.normalizedValue!==a[c.name]&&(this.SetFieldValue(c,h.normalizedValue),a[c.name]=h.normalizedValue)}if(d)return this.DisplayGlobalError(this.m_FormDefinition.errorMessages.checkInlineErrors),this.NotifySizeChange(),f&&m({event:"validationError"}),{gotValidationError:!0};f&&m({event:"validationSuccess"});return{gotValidationError:!1,formValues:a}},ShowFormDatePicker:function(a,
b){var c=this;l.datepicker.ShowDatePickerForInput(a,b,this.m_FormDefinition.culture,function(b){c.SetFieldValue(c.GetFieldDefByInputID(a),b)})}}});d.ClientBaseForm=q})(window.ofsysGenericClientForm.clientBaseForm);
(function(d){var m=window.ofsysGenericClientForm,h=m.util,l={_waitingForRecaptcha:[],NotifyRecaptchaIsReady:function(){for(var d=0;d<l._waitingForRecaptcha.length;d++)l._waitingForRecaptcha[d].fn(l._waitingForRecaptcha[d].data);l._waitingForRecaptcha=[]},WhenRecaptchaLoaded:function(d,a){null!=window.grecaptcha?a(d):l._waitingForRecaptcha.push({data:d,fn:a})}};d.RecaptchaHelper=l;window.ofsysForm_NotifyRecaptchaIsReady=m.baseFormUtils.RecaptchaHelper.NotifyRecaptchaIsReady;d.InitSimulatedPlaceholder=
function(d){if(d.hasClass("DialogInsightInputWithPlaceholder")){var a=d.firstParentMatching(".DialogInsightInputWithPlaceholderContainer");null!=a&&(0<h.string.trim(d.getValue()).length&&a.addClass("PlaceholderInputHasText"),d.on("input",{input:d,placeholderContainer:a},function(a,c){var b=c.input.getValue();0<h.string.trim(b).length||0<=b.indexOf("\n")?c.placeholderContainer.addClass("PlaceholderInputHasText"):c.placeholderContainer.removeClass("PlaceholderInputHasText")}))}}})(window.ofsysGenericClientForm.baseFormUtils);
(function(d){var m=window.ofsysGenericClientForm.util;d.GetValidator=function(h){var l=h.split(".");if(2==l.length){var e=l[0];h=l[1];if(null!=d[e]&&null!=d[e][h])return d[e][h]}return null!=d.builtInValidators[h]?d.builtInValidators[h]:null};d.builtInValidators={required:{fn:function(d,l){return null===d||void 0===d||0==d.length||!1===d?{status:"incomplete",errorCode:"recaptcha"==l.inputType||"invisible_recaptcha"==l.inputType?"recaptcha":"required"}:{status:"success"}}},"int":{fn:function(d,l){return/^(-)?\d+$/i.test(d)?
{status:"success"}:{status:"error",errorCode:"dataType"}}},"float":{fn:function(d,l){return/^(-)?\d+([.]\d+)?$/i.test(d)?{status:"success"}:{status:"error",errorCode:"dataType"}}},minmax:{fn:function(d,l){var e=parseFloat(d);return(null==l.min||e>=l.min)&&(null==l.max||e<=l.max)?{status:"success"}:{status:"error",errorCode:"interval"}}},email:{fn:function(d,l){return/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i.test(d)?{status:"success"}:
{status:"error",errorCode:"inputMask"}}},date:{fn:function(d,l){var e=/^(\d+)[.-](\d+)[.-](\d+)$/gm.exec(d),a=null;if(null!=e&&4==e.length)var a=m.parseInt(e[1]),b=m.parseInt(e[2])-1,e=m.parseInt(e[3]),a=m.datetime.buildDateWithStrictValidation(a,b,e,0,0,0);return null!=a?{status:"success"}:{status:"error",errorCode:"inputMask"}}},datetime:{fn:function(d,l){return null!=m.datetime.parseOFSYSDateTime(d)?{status:"success"}:{status:"error",errorCode:"inputMask"}}}}})(DI.Validators.Libraries);
